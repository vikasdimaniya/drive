{% load static %}
<!DOCTYPE html>
<html>

<head>
    <title>MyDrive Dashboard</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        /* Basic styles to prevent FOUC (Flash of Unstyled Content) */
        body { margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; }
        .navbar { background-color: #0078D7; color: white; padding: 15px 20px; display: flex; justify-content: space-between; }
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
    </style>
    <!-- Custom CSS -->
    <link rel="stylesheet" href="{% static 'css/base.css' %}">
    <link rel="stylesheet" href="{% static 'css/dashboard.css' %}">
    <link rel="stylesheet" href="{% static 'css/file-explorer.css' %}">
</head>

<body>
    <div class="navbar">
        <h1><i class="fas fa-hdd"></i> MyDrive</h1>
        <div class="user-info">
            <span>Welcome, {{ user.first_name|default:user.username }}!</span>
            <form action="{% url 'logout' %}" method="post" style="display: inline;">
                {% csrf_token %}
                <button type="submit" class="logout-btn"><i class="fas fa-sign-out-alt"></i> Logout</button>
            </form>
        </div>
    </div>
    
    <div class="container">
        <div class="dashboard-grid">
            <div class="sidebar">
                <div class="user-profile">
                    <div class="user-avatar">{{ user.first_name|first|upper }}{{ user.last_name|first|upper }}</div>
                    <div class="user-details">
                        <div class="user-name">{{ user.first_name }} {{ user.last_name }}</div>
                        <div class="user-email">{{ user.username }}</div>
                    </div>
                </div>
                
                <ul class="sidebar-menu">
                    <li><a href="#" class="active"><i class="fas fa-home"></i> Dashboard</a></li>
                    <li><a href="#"><i class="fas fa-folder"></i> My Files</a></li>
                    <li><a href="#"><i class="fas fa-share-alt"></i> Shared Files</a></li>
                    <li><a href="#"><i class="fas fa-trash"></i> Trash</a></li>
                    <li><a href="#"><i class="fas fa-cog"></i> Settings</a></li>
                </ul>
            </div>
            
            <div class="main-content">
                <div class="upload-section">
                    <h3><i class="fas fa-cloud-upload-alt"></i> Upload Files</h3>
                    <div class="file-input-container">
                        <div class="custom-file-input">
                            <input type="file" id="fileInput">
                            <div class="file-input-label" id="fileLabel">Choose a file...</div>
                        </div>
                        <button class="upload-btn" id="uploadBtn"><i class="fas fa-upload"></i> Upload</button>
                    </div>
                    <div class="progress-container" id="progressContainer">
                        <div class="progress-bar">
                            <div class="progress-fill" id="progressFill"></div>
                        </div>
                        <div class="progress-text" id="progressText">0%</div>
                    </div>
                </div>
                
                <div class="search-section">
                    <div class="search-container">
                        <input type="text" id="searchQuery" class="search-input" placeholder="Search files...">
                        <button class="search-btn" id="searchBtn"><i class="fas fa-search"></i></button>
                    </div>
                </div>
                
                <!-- View Options Bar (macOS Finder style) -->
                <div class="view-options-bar">
                    <div class="view-options">
                        <button class="view-option-btn active" data-view="grid" title="Grid View">
                            <i class="fas fa-th-large"></i>
                        </button>
                        <button class="view-option-btn" data-view="list" title="List View">
                            <i class="fas fa-list"></i>
                        </button>
                        <button class="view-option-btn" data-view="columns" title="Column View">
                            <i class="fas fa-columns"></i>
                        </button>
                    </div>
                    <div class="view-size">
                        <button class="size-option-btn" data-size="small" title="Small Icons">
                            <i class="fas fa-compress"></i>
                        </button>
                        <button class="size-option-btn active" data-size="medium" title="Medium Icons">
                            <i class="fas fa-expand"></i>
                        </button>
                        <button class="size-option-btn" data-size="large" title="Large Icons">
                            <i class="fas fa-expand-arrows-alt"></i>
                        </button>
                    </div>
                    <div class="sort-options">
                        <select id="sortSelect" class="sort-select">
                            <option value="name">Name</option>
                            <option value="date">Date</option>
                            <option value="size">Size</option>
                            <option value="type">Type</option>
                        </select>
                    </div>
                </div>
                
                <div class="files-section">
                    <h3><i class="fas fa-folder-open"></i> Your Files</h3>
                    <div id="filesContainer" class="files-container view-grid size-medium">
                        <div class="empty-message">Loading files...</div>
                    </div>
                </div>
                
                <div class="files-section" style="margin-top: 30px; display: none;" id="searchResultsSection">
                    <h3><i class="fas fa-search"></i> Search Results</h3>
                    <div id="searchResultsContainer" class="files-container view-grid size-medium"></div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- JavaScript -->
    <script src="{% static 'js/utils.js' %}"></script>
    <script src="{% static 'js/file-explorer.js' %}"></script>
    <script src="{% static 'js/upload.js' %}"></script>
    <script src="{% static 'js/search.js' %}"></script>
    
    <!-- Inline script for initialization -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize file explorer
            initFileExplorer();
            
            // Initialize upload functionality
            initUpload();
            
            // Initialize search functionality
            initSearch();
        });
    </script>
</body>

</html>